"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7033],{31371:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>o});var i=s(74848),t=s(28453);const r={title:"GraphQL Configuration",description:"Enhance your GraphQL API with Tailcall DSL's custom directives. These directives offer powerful compile-time guarantees, ensuring robust and optimized API composition. Tailcall automates the generation of resolver logic for improved performance.",slug:"tailcall-dsl-graphql-custom-directives",sidebar_label:"Configuration",sidebar_position:5},a=void 0,l={id:"directives",title:"GraphQL Configuration",description:"Enhance your GraphQL API with Tailcall DSL's custom directives. These directives offer powerful compile-time guarantees, ensuring robust and optimized API composition. Tailcall automates the generation of resolver logic for improved performance.",source:"@site/docs/directives.md",sourceDirName:".",slug:"/tailcall-dsl-graphql-custom-directives",permalink:"/docs/tailcall-dsl-graphql-custom-directives",draft:!1,unlisted:!1,editUrl:"https://github.com/tailcallhq/tailcallhq.github.io/tree/develop/docs/directives.md",tags:[],version:"current",lastUpdatedAt:1728471708e3,sidebarPosition:5,frontMatter:{title:"GraphQL Configuration",description:"Enhance your GraphQL API with Tailcall DSL's custom directives. These directives offer powerful compile-time guarantees, ensuring robust and optimized API composition. Tailcall automates the generation of resolver logic for improved performance.",slug:"tailcall-dsl-graphql-custom-directives",sidebar_label:"Configuration",sidebar_position:5},sidebar:"docs",previous:{title:"Command Line",permalink:"/docs/tailcall-graphql-cli"},next:{title:"Resolver Context",permalink:"/docs/graphql-resolver-context-tailcall"}},c={},o=[{value:"@addField Directive",id:"addfield-directive",level:2},{value:"@cache Directive",id:"cache-directive",level:2},{value:"maxAge",id:"maxage",level:3},{value:"Usage",id:"usage",level:3},{value:"Cache Key",id:"cache-key",level:3},{value:"@call Directive",id:"call-directive",level:2},{value:"steps",id:"steps",level:3},{value:"query",id:"query",level:3},{value:"mutation",id:"mutation",level:3},{value:"args",id:"args",level:3},{value:"Composition",id:"composition",level:3},{value:"@expr Directive",id:"expr-directive",level:2},{value:"Static",id:"static",level:3},{value:"Dynamic",id:"dynamic",level:3},{value:"@graphQL Directive",id:"graphql-directive",level:2},{value:"baseURL",id:"baseurl",level:3},{value:"name",id:"name",level:3},{value:"args",id:"args-1",level:3},{value:"headers",id:"headers",level:3},{value:"batch",id:"batch",level:3},{value:"@grpc Directive",id:"grpc-directive",level:2},{value:"method",id:"method",level:3},{value:"baseURL",id:"baseurl-1",level:3},{value:"body",id:"body",level:3},{value:"headers",id:"headers-1",level:3},{value:"batchKey",id:"batchkey",level:3},{value:"onResponseBody",id:"onresponsebody",level:3},{value:"select",id:"select",level:3},{value:"@http Directive",id:"http-directive",level:2},{value:"baseURL",id:"baseurl-2",level:3},{value:"path",id:"path",level:3},{value:"method",id:"method-1",level:3},{value:"query",id:"query-1",level:3},{value:"body",id:"body-1",level:3},{value:"headers",id:"headers-2",level:3},{value:"batchKey",id:"batchkey-1",level:3},{value:"onRequest",id:"onrequest",level:3},{value:"onResponseBody",id:"onresponsebody-1",level:3},{value:"select",id:"select-1",level:3},{value:"@js Directive",id:"js-directive",level:2},{value:"Usage",id:"usage-1",level:3},{value:"Syntax",id:"syntax",level:3},{value:"Example",id:"example",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Performance Considerations",id:"performance-considerations",level:3},{value:"@link Directive",id:"link-directive",level:2},{value:"How it Works",id:"how-it-works",level:3},{value:"Example",id:"example-1",level:3},{value:"Supported Types",id:"supported-types",level:3},{value:"Config",id:"config",level:3},{value:"Protobuf",id:"protobuf",level:3},{value:"Script",id:"script",level:3},{value:"Cert",id:"cert",level:3},{value:"Key",id:"key",level:3},{value:"Operation",id:"operation",level:3},{value:"Htpasswd",id:"htpasswd",level:3},{value:"Jwks",id:"jwks",level:3},{value:"@modify Directive",id:"modify-directive",level:2},{value:"name",id:"name-1",level:3},{value:"omit",id:"omit",level:3},{value:"@omit Directive",id:"omit-directive",level:2},{value:"How it works",id:"how-it-works-1",level:3},{value:"Example",id:"example-2",level:3},{value:"Comparison with <code>modify</code>",id:"comparison-with-modify",level:3},{value:"@protected Directive",id:"protected-directive",level:2},{value:"How It Works",id:"how-it-works-2",level:3},{value:"@rest Directive",id:"rest-directive",level:2},{value:"Usage",id:"usage-2",level:3},{value:"Example",id:"example-3",level:3},{value:"@server Directive",id:"server-directive",level:2},{value:"workers",id:"workers",level:3},{value:"port",id:"port",level:3},{value:"headers",id:"headers-3",level:3},{value:"cacheControl",id:"cachecontrol",level:3},{value:"custom",id:"custom",level:3},{value:"experimental",id:"experimental",level:3},{value:"setCookies",id:"setcookies",level:3},{value:"cors",id:"cors",level:3},{value:"vars",id:"vars",level:3},{value:"introspection",id:"introspection",level:3},{value:"queryValidation",id:"queryvalidation",level:3},{value:"responseValidation",id:"responsevalidation",level:3},{value:"globalResponseTimeout",id:"globalresponsetimeout",level:3},{value:"version",id:"version",level:3},{value:"cert",id:"cert-1",level:3},{value:"key",id:"key-1",level:3},{value:"showcase",id:"showcase",level:3},{value:"batchRequests",id:"batchrequests",level:3},{value:"dedupe",id:"dedupe",level:3},{value:"routes",id:"routes",level:3},{value:"enableFederation",id:"enablefederation",level:3},{value:"@telemetry Directive",id:"telemetry-directive",level:2},{value:"Traces",id:"traces",level:3},{value:"Metrics",id:"metrics",level:3},{value:"export",id:"export",level:3},{value:"otlp",id:"otlp",level:3},{value:"prometheus",id:"prometheus",level:3},{value:"stdout",id:"stdout",level:3},{value:"requestHeaders",id:"requestheaders",level:3},{value:"apollo",id:"apollo",level:3},{value:"@upstream Directive",id:"upstream-directive",level:2},{value:"poolIdleTimeout",id:"poolidletimeout",level:3},{value:"poolMaxIdlePerHost",id:"poolmaxidleperhost",level:3},{value:"keepAliveInterval",id:"keepaliveinterval",level:3},{value:"keepAliveTimeout",id:"keepalivetimeout",level:3},{value:"keepAliveWhileIdle",id:"keepalivewhileidle",level:3},{value:"proxy",id:"proxy",level:3},{value:"connectTimeout",id:"connecttimeout",level:3},{value:"timeout",id:"timeout",level:3},{value:"tcpKeepAlive",id:"tcpkeepalive",level:3},{value:"userAgent",id:"useragent",level:3},{value:"allowedHeaders",id:"allowedheaders",level:3},{value:"baseURL",id:"baseurl-3",level:3},{value:"httpCache",id:"httpcache",level:3},{value:"Tips",id:"tips",level:3},{value:"batch",id:"batch-1",level:3},{value:"onRequest",id:"onrequest-1",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Tailcall DSL builds on your existing GraphQL knowledge by allowing the addition of some custom directives. These directives provide powerful compile time guarantees to ensure your API composition is tight and robust. Tailcall automatically generates highly optimized resolver logic for your types using the information in the directives."}),"\n",(0,i.jsx)(n.p,{children:"Here is a list of all the custom directives supported by Tailcall:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Operator"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#addfield-directive",children:(0,i.jsx)(n.code,{children:"@addField"})})}),(0,i.jsx)(n.td,{children:"Simplifies data structures and queries by adding, inlining, or flattening fields or nodes within the schema."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#cache-directive",children:(0,i.jsx)(n.code,{children:"@cache"})})}),(0,i.jsx)(n.td,{children:"Enables caching for the query, field or type applied to."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#call-directive",children:(0,i.jsx)(n.code,{children:"@call"})})}),(0,i.jsx)(n.td,{children:"Invokes a query or mutation from another query or mutation field."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#expr-directive",children:(0,i.jsx)(n.code,{children:"@expr"})})}),(0,i.jsx)(n.td,{children:"Allows embedding of a constant response within the schema."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#graphql-directive",children:(0,i.jsx)(n.code,{children:"@graphQL"})})}),(0,i.jsx)(n.td,{children:"Resolves a field or node by a GraphQL API."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#grpc-directive",children:(0,i.jsx)(n.code,{children:"@grpc"})})}),(0,i.jsx)(n.td,{children:"Resolves a field or node by a gRPC API."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#http-directive",children:(0,i.jsx)(n.code,{children:"@http"})})}),(0,i.jsx)(n.td,{children:"Resolves a field or node by a REST API."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#link-directive",children:(0,i.jsx)(n.code,{children:"@link"})})}),(0,i.jsx)(n.td,{children:"Imports external resources such as config files, certs, protobufs, etc in the schema."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#modify-directive",children:(0,i.jsx)(n.code,{children:"@modify"})})}),(0,i.jsx)(n.td,{children:"Enables changes to attributes of fields or nodes in the schema."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#omit-directive",children:(0,i.jsx)(n.code,{children:"@omit"})})}),(0,i.jsx)(n.td,{children:"Excludes fields or nodes from the generated schema, making them inaccessible through the GraphQL API."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#rest-directive",children:(0,i.jsx)(n.code,{children:"@rest"})})}),(0,i.jsx)(n.td,{children:"Allows exposing REST endpoints on top of GraphQL."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#server-directive",children:(0,i.jsx)(n.code,{children:"@server"})})}),(0,i.jsx)(n.td,{children:"Provides server configurations for behavior tuning and tailcall optimization in specific use-cases."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#telemetry-directive",children:(0,i.jsx)(n.code,{children:"@telemetry"})})}),(0,i.jsx)(n.td,{children:"Integrates with open-telemetry to provide observability of the running tailcall service."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#upstream-directive",children:(0,i.jsx)(n.code,{children:"@upstream"})})}),(0,i.jsx)(n.td,{children:"Controls aspects of the upstream server connection, including timeouts and keep-alive settings."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"addfield-directive",children:"@addField Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@addField"})," directive simplifies data structures and queries by adding a field that ",(0,i.jsx)(n.em,{children:"inline"})," or flattens a nested field or node within your schema. It modifies the schema and the data transformation process, making nested data more accessible and straightforward to present."]}),"\n",(0,i.jsx)(n.p,{children:"For instance, consider a schema:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema {\n  query: Query\n}\n\ntype User\n  @addField(name: "street", path: ["address", "street"]) {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n  address: Address @modify(omit: true)\n}\n\ntype Address {\n  street: String!\n  city: String!\n  state: String!\n}\n\ntype Query {\n  user(id: Int!): User @http(path: "/users/{{.args.id}}")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Suppose we focus on the ",(0,i.jsx)(n.code,{children:"street"})," field in ",(0,i.jsx)(n.code,{children:"Address"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["In this case, applying the ",(0,i.jsx)(n.code,{children:"@addField"})," directive to the ",(0,i.jsx)(n.code,{children:"User"})," type creates a ",(0,i.jsx)(n.code,{children:"street"})," field within the ",(0,i.jsx)(n.code,{children:"User"})," type. It uses a ",(0,i.jsx)(n.code,{children:"path"})," argument to specify the sequence of fields from a declared field (",(0,i.jsx)(n.code,{children:"address"}),"), leading to the ",(0,i.jsx)(n.code,{children:"Address"})," field to add. We also can apply ",(0,i.jsx)(n.code,{children:"@modify(omit: true)"})," to remove the ",(0,i.jsx)(n.code,{children:"address"})," field from the schema, as the ",(0,i.jsx)(n.code,{children:"street"})," field from ",(0,i.jsx)(n.code,{children:"Address"})," is now directly accessible on the ",(0,i.jsx)(n.code,{children:"User"})," type."]}),"\n",(0,i.jsx)(n.p,{children:"Post application, the schema becomes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema {\n  query: Query\n}\n\ntype User {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n  street: String\n}\n\ntype Query {\n  user(id: Int): Post!\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In the above example, since we added a ",(0,i.jsx)(n.code,{children:"@modify(omit: true)"})," on the ",(0,i.jsx)(n.code,{children:"address"})," field, the schema no longer includes the ",(0,i.jsx)(n.code,{children:"Address"})," type."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@addField"})," directive also take cares of nullablity of the fields. If any of the fields in the path is nullable, the resulting type will be nullable."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@addField"})," also supports indexing, allowing for the specification of an array index for inline inclusion. For instance, if a field ",(0,i.jsx)(n.code,{children:"posts"})," is of type ",(0,i.jsx)(n.code,{children:"[Post]"}),", and the goal is to access the title of the first post, specify the path as [",(0,i.jsx)(n.code,{children:'"posts"'}),",",(0,i.jsx)(n.code,{children:'"0"'}),",",(0,i.jsx)(n.code,{children:'"title"'}),"]."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type User\n  @addField(\n    name: "firstPostTitle"\n    path: ["posts", "0", "title"]\n  ) {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n  posts: Post @http(path: "/users/{{.value.id}}/posts")\n}\n\ntype Post {\n  id: Int!\n  userId: Int!\n  title: String!\n  body: String!\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In conclusion, the ",(0,i.jsx)(n.code,{children:"@addField"})," directive helps tidy up your schema and streamline data fetching by reducing query depth, promoting better performance and simplicity."]}),"\n",(0,i.jsx)(n.h2,{id:"cache-directive",children:"@cache Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@cache"})," directive provides a protocol agnostic mechanism for caching the results of fields within a GraphQL schema. Like any other cache implementation, this feature is useful for optimizing performance by reducing the need to fetch data that doesn't change frequently."]}),"\n",(0,i.jsx)(n.h3,{id:"maxage",children:"maxAge"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"@cache(maxAge: Int)\n"})}),"\n",(0,i.jsx)(n.p,{children:"This parameter is a non-zero unsigned integer specifying the duration, in milliseconds, that retains the cached value."}),"\n",(0,i.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.p,{children:"Consider the following GraphQL schema example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int\n  title: String\n  userId: Int @cache(maxAge: 100)\n  user: User\n    @http(path: "/user/{{.value.userId}}")\n    @cache(maxAge: 200)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this configuration, the system caches the result of the ",(0,i.jsx)(n.code,{children:"user"})," field due to its association with an HTTP resolver. But it does not cache the values of ",(0,i.jsx)(n.code,{children:"userId"})," and ",(0,i.jsx)(n.code,{children:"title"})," because they lack individual resolvers; the resolver for the ",(0,i.jsx)(n.code,{children:"posts"})," field retrieves their values, employing the ",(0,i.jsx)(n.code,{children:'@http(path: "/posts")'})," directive."]}),"\n",(0,i.jsxs)(n.p,{children:["Applying the ",(0,i.jsx)(n.code,{children:"@cache"})," directive at the type level affects all fields within that type. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post @cache(maxAge: 100) {\n  id: Int\n  title: String\n  userId: Int\n  user: User @http(path: "/user/{{.value.userId}}")\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You can simplify this configuration to show that applying the ",(0,i.jsx)(n.code,{children:"@cache"})," directive to a type means every field within that type inherits it:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int @cache(maxAge: 100)\n  title: String @cache(maxAge: 100)\n  userId: Int @cache(maxAge: 100)\n  user: User\n    @http(path: "/user/{{.value.userId}}")\n    @cache(maxAge: 100)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Since the ",(0,i.jsx)(n.code,{children:"@cache"})," directive does not affect fields without resolvers, the effective configuration can be further reduced as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int\n  title: String\n  userId: Int\n  user: User\n    @http(path: "/user/{{.value.userId}}")\n    @cache(maxAge: 100)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["When applying the ",(0,i.jsx)(n.code,{children:"@cache"})," directive both at the type level and on individual fields within that type, the field-level directive takes precedence:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post @cache(maxAge: 200) {\n  id: Int\n  title: String\n  userId: Int\n  user: User\n    @http(path: "/user/{{.value.userId}}")\n    @cache(maxAge: 100)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Thus, in the configuration above, while all fields inherit the ",(0,i.jsx)(n.code,{children:"@cache(maxAge: 200)"})," directive at the type level, the ",(0,i.jsx)(n.code,{children:"user"})," field's explicit ",(0,i.jsx)(n.code,{children:"@cache(maxAge: 100)"})," directive takes precedence."]}),"\n",(0,i.jsx)(n.h3,{id:"cache-key",children:"Cache Key"}),"\n",(0,i.jsx)(n.p,{children:"The caching mechanism generates a hash based on information related to the applied query to serve as the cache key for the corresponding value."}),"\n",(0,i.jsxs)(n.p,{children:["For instance, the system caches the ",(0,i.jsx)(n.code,{children:"user"})," field in the following configuration, using the hash of the interpolated string ",(0,i.jsx)(n.code,{children:'"/user/{{.value.userId}}"'})," as the cache key. For example, if ",(0,i.jsx)(n.code,{children:"Post.userId"})," equals ",(0,i.jsx)(n.code,{children:"1"}),", the system generates the cache key by hashing the string ",(0,i.jsx)(n.code,{children:'"/users/1"'}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"call-directive",children:"@call Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@call"})," directive in GraphQL signifies a shift towards more efficient configuration management by introducing a methodology akin to function invocations in conventional programming. This directive is pivotal for developers navigating the intricacies of elaborate GraphQL schemas, where minimizing redundancy and adhering to the DRY (Don't Repeat Yourself) principle are paramount. Consider the following schema example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    baseURL: "https://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n}\n\ntype Query {\n  # highlight-start\n  user(id: Int!): User @http(path: "/users/{{.args.id}}")\n  # highlight-end\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int!\n  userId: Int!\n  title: String!\n  body: String!\n  # highlight-start\n  user: User @http(path: "/users/{{.value.userId}}")\n  # highlight-end\n}\n\ntype User {\n  id: Int!\n  name: String!\n  email: String!\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this schema, at lines ",(0,i.jsx)(n.code,{children:"9"})," and ",(0,i.jsx)(n.code,{children:"18"}),", a pattern of configuration duplication emerges when fetching user's data by its id, demonstrating a prime use case for the ",(0,i.jsx)(n.code,{children:"@call"})," directive. Through refactoring the ",(0,i.jsx)(n.code,{children:"Post"})," type to incorporate the ",(0,i.jsx)(n.code,{children:"@call"})," directive, we can eliminate this redundancy."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Post {\n  id: Int!\n  userId: Int!\n  title: String!\n  body: String!\n  # highlight-start\n  user: User\n    @call(\n      steps: [\n        {query: "user", args: {id: "{{.value.userId}}"}}\n      ]\n    )\n  # highlight-end\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Here, the ",(0,i.jsx)(n.code,{children:"@call"})," directive invokes the ",(0,i.jsx)(n.code,{children:"user"})," query from the ",(0,i.jsx)(n.code,{children:"Query"})," type, leveraging the data-fetching process that's already defined in the root ",(0,i.jsx)(n.code,{children:"query"}),". The ",(0,i.jsx)(n.code,{children:"query"})," parameter specifies the target field, while the ",(0,i.jsx)(n.code,{children:"args"})," parameter delineates the arguments to be passed."]}),"\n",(0,i.jsx)(n.h3,{id:"steps",children:"steps"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@call"})," directive can compose together other resolvers, allowing to create a chain of resolvers that can be executed in sequence. This is done by using the ",(0,i.jsx)(n.code,{children:"steps"})," parameter, which is an array of objects that define the operations to be executed."]}),"\n",(0,i.jsx)(n.h3,{id:"query",children:"query"}),"\n",(0,i.jsxs)(n.p,{children:["Specify the root ",(0,i.jsx)(n.strong,{children:"query"})," field to invoke, alongside the requisite arguments, using the ",(0,i.jsx)(n.code,{children:"@call"})," directive for a concise and efficient query structure."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Post {\n  userId: Int!\n  user: User\n    @call(\n      steps: [\n        {query: "user", args: {id: "{{.value.userId}}"}}\n      ]\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"mutation",children:"mutation"}),"\n",(0,i.jsxs)(n.p,{children:["Similarly, the ",(0,i.jsx)(n.code,{children:"@call"})," directive can facilitate calling a mutation from another mutation field, employing the ",(0,i.jsx)(n.code,{children:"mutation"})," parameter for field specification and the ",(0,i.jsx)(n.code,{children:"args"})," parameter for argument delineation."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Mutation {\n  insertPost(input: PostInput, overwrite: Boolean): Post\n    @http(\n      body: "{{.args.input}}"\n      method: "POST"\n      path: "/posts"\n      query: {overwrite: "{{.args.overwrite}}"}\n    )\n\n  upsertPost(input: PostInput): Post\n    @call(\n      steps: [\n        {\n          mutation: "insertPost"\n          args: {input: "{{.args.input}}", overwrite: true}\n        }\n      ]\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"args",children:"args"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"args"})," parameter in the ",(0,i.jsx)(n.code,{children:"@call"})," directive facilitates passing arguments to the targeted query or mutation, represented as a key-value mapping where each key corresponds to an argument name and its associated value."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Post {\n  userId: Int!\n  user: User\n    @call(\n      steps: [\n        {query: "user", args: {id: "{{.value.userId}}"}}\n      ]\n    )\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@call"})," directive is predominantly advantageous in complex, large-scale configurations. For those new to GraphQL or Tailcall, it may be beneficial to explore this directive after familiarizing yourself with the foundational aspects of GraphQL."]})}),"\n",(0,i.jsx)(n.h3,{id:"composition",children:"Composition"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@call"})," directive provides the ability to express a sequence of steps that one might need to compose. These steps are executed such that the result of each step is passed as an argument to the next step. The ",(0,i.jsx)(n.code,{children:"query"})," and ",(0,i.jsx)(n.code,{children:"mutation"})," parameters are used to specify the target field, while the ",(0,i.jsx)(n.code,{children:"args"})," parameter is used to pass arguments to the target field."]}),"\n",(0,i.jsx)(n.p,{children:"Let's explain this with an example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema @server {\n  query: Query\n}\n\ntype Query {\n  a(input: JSON): JSON\n    @expr(body: {value: "{{.args.input.a}}"})\n\n  b(input: JSON): JSON\n    @expr(body: {value: "{{.args.input.b}}"})\n\n  c(input: JSON): JSON\n    @expr(body: {value: "{{.args.input.c}}"})\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Here we have defined there operations viz. ",(0,i.jsx)(n.code,{children:"a"}),", ",(0,i.jsx)(n.code,{children:"b"})," & ",(0,i.jsx)(n.code,{children:"c"})," each of them pluck their respective keys from the given input value. Let's run this query with some test input:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"{\n  a(input: {a: 100})\n  b(input: {b: 200})\n  c(input: {c: 300})\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Here is how the response would look like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "a": {\n      "value": 100\n    },\n    "b": {\n      "value": 200\n    },\n    "c": {\n      "value": 300\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["As you can see the ",(0,i.jsx)(n.a,{href:"#expr-directive",children:(0,i.jsx)(n.code,{children:"@expr"})})," directive plucks the inner value and returns the result. How about we implement an ",(0,i.jsx)(n.code,{children:"abc"})," operation that could leverage the existing operations and unwrap the following input value:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{"a": {"b": {"c": {"d": 1000}}}}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Given the above input if we wish to extract the last inner number ",(0,i.jsx)(n.code,{children:"1000"})," then we could define a new operation as follows"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema @server {\n  query: Query\n}\n\ntype Query {\n  a(input: JSON): JSON\n    @expr(body: {value: "{{.args.input.a}}"})\n\n  b(input: JSON): JSON\n    @expr(body: {value: "{{.args.input.b}}"})\n\n  c(input: JSON): JSON\n    @expr(body: {value: "{{.args.input.c}}"})\n\n  # highlight-start\n  abc(input: JSON): JSON\n    @call(\n      steps: [\n        {query: "a", args: {input: "{{.args.input}}"}}\n        {query: "b", args: {input: "{{.args.value}}"}}\n        {query: "c", args: {input: "{{.args.value}}"}}\n      ]\n    )\n  # highlight-end\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["We use the ",(0,i.jsx)(n.code,{children:"@call"})," directive to compose the operations together. The ",(0,i.jsx)(n.code,{children:"args"})," specify how we would like to pass the arguments to the operation and the result of that operation is passed to the next step. We can test the new ",(0,i.jsx)(n.code,{children:"abc"})," operation with the following query:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"query {\n  abc(input: {a: {b: {c: 1000}}})\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"The server returns the response that we expected:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "abc": {\n      "value": 100\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This way you can compose combine multiple operations can compose them together using the ",(0,i.jsx)(n.code,{children:"@call"})," directive."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["We use ",(0,i.jsx)(n.code,{children:"JSON"})," scalar here because we don't care about the type safety of this option. In a real world example you might want to use proper input and output types."]})}),"\n",(0,i.jsx)(n.h2,{id:"expr-directive",children:"@expr Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@expr"})," directive in GraphQL is a powerful tool for embedding data directly into your schema, offering two primary functionalities:"]}),"\n",(0,i.jsx)(n.h3,{id:"static",children:"Static"}),"\n",(0,i.jsx)(n.p,{children:"This feature allows for the inclusion of a constant response within the schema definition itself. It is useful for scenarios where the response is unchanging. e.g:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema {\n  query: Query\n}\n\ntype Query {\n  user: User @expr(body: {name: "John", age: 12})\n}\n\ntype User {\n  name: String\n  age: Int\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@expr"})," directive also checks the provided value at compile time to ensure it matches the field's schema. If not, the console displays a descriptive error message."]}),"\n",(0,i.jsx)(n.h3,{id:"dynamic",children:"Dynamic"}),"\n",(0,i.jsxs)(n.p,{children:["Beyond static data embedding, the ",(0,i.jsx)(n.code,{children:"@expr"})," directive extends its utility to support dynamic data injection through Mustache template syntax. This feature enables the use of placeholders within the constant data, which are then dynamically replaced with actual values at runtime. It supports both scalar values and complex objects, including lists and nested objects, offering flexibility in tailoring responses to specific needs. e.g:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema {\n  query: Query\n}\n\ntype Query {\n  user: User\n    @expr(\n      body: {\n        name: "John"\n        workEmail: "john@xyz.com"\n        personalEmail: "john@xyz.com"\n      }\n    )\n}\n\ntype User {\n  name: String\n  age: Int\n  personalEmail: String\n  workEmail: String\n  emails: Emails\n    @expr(\n      body: {\n        emails: {\n          workEmail: "{{.value.workEmail}}"\n          personalEmail: "{{.value.personalEmail}}"\n        }\n      }\n    )\n}\n\ntype Emails {\n  workEmail: String\n  personalEmail: String\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the ",(0,i.jsx)(n.code,{children:"@expr"})," directive dynamically generate an ",(0,i.jsx)(n.code,{children:"Emails"})," object based on the provided template data. The placeholders within the template (",(0,i.jsx)(n.code,{children:"{{.value.workEmail}}"})," and ",(0,i.jsx)(n.code,{children:"{{.value.personalEmail}}"}),") gets replaced with the actual values specified in the ",(0,i.jsx)(n.code,{children:"User"})," type, allowing for dynamic content generation while still adhering to the schema's structure."]}),"\n",(0,i.jsx)(n.h2,{id:"graphql-directive",children:"@graphQL Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@graphQL"})," directive allows to specify GraphQL API server request to fetch data from."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  users: [User] @graphQL(name: "userList")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@graphQL"})," directive facilitates fetching a list of users from the GraphQL API upstream. The ",(0,i.jsx)(n.a,{href:"#name",children:"name"})," argument specifies the root field's name on the upstream server. The upcoming request to the GraphQL server determines the ",(0,i.jsx)(n.code,{children:"User"})," type's inner fields for the request. Depending on the operation type within which one finds the ",(0,i.jsx)(n.code,{children:"@graphQL"})," directive, the GraphQL configuration determines the query's operation type."]}),"\n",(0,i.jsx)(n.p,{children:"For the next request with the config above:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"query {\n  users {\n    id\n    name\n  }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Tailcall will request the next query for the upstream:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"query {\n  userList {\n    id\n    name\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"baseurl",children:"baseURL"}),"\n",(0,i.jsxs)(n.p,{children:["This refers to the base URL of the API. If not specified, the default base URL is the one specified in the ",(0,i.jsx)(n.a,{href:"#upstream-directive",children:(0,i.jsx)(n.code,{children:"@upstream"})})," directive."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  users: [User]\n    @graphQL(\n      name: "users"\n      baseURL: "https://graphqlzero.almansi.me/api"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"name",children:"name"}),"\n",(0,i.jsx)(n.p,{children:"The root field's name on the upstream to request data from. For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  users: [User] @graphQL(name: "userList")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["When Tailcall receives a query for the ",(0,i.jsx)(n.code,{children:"users"})," field, it will request a query for ",(0,i.jsx)(n.code,{children:"userList"})," from the upstream."]}),"\n",(0,i.jsx)(n.h3,{id:"args-1",children:"args"}),"\n",(0,i.jsx)(n.p,{children:"Named arguments for the requested field. For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  user: User\n    @graphQL(\n      name: "user"\n      args: [{key: "id", value: "{{.value.userId}}"}]\n    )\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Will request the next query from the upstream for the first user's name:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"query {\n  user(id: 1) {\n    name\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"headers",children:"headers"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"headers"})," parameter allows customizing the headers of the GraphQL request made by the ",(0,i.jsx)(n.code,{children:"@graphQL"})," directive. Specifying a key-value map of header names and their values achieves this."]}),"\n",(0,i.jsx)(n.p,{children:"For instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Mutation {\n  users: User\n    @graphQL(\n      name: "users"\n      headers: [{key: "X-Server", value: "Tailcall"}]\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, a request to ",(0,i.jsx)(n.code,{children:"/users"})," will include the HTTP header ",(0,i.jsx)(n.code,{children:"X-Server"})," with the value ",(0,i.jsx)(n.code,{children:"Tailcall"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"batch",children:"batch"}),"\n",(0,i.jsxs)(n.p,{children:["In case the upstream GraphQL server supports request batching, we can specify the ",(0,i.jsx)(n.code,{children:"batch"})," argument to batch requests to a single upstream into a single batch request. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    batch: {\n      maxSize: 1000\n      delay: 10\n      headers: ["X-Server", "Authorization"]\n    }\n  ) {\n  query: Query\n  mutation: Mutation\n}\n\ntype Query {\n  users: [User] @graphQL(name: "users", batch: true)\n  posts: [Post] @graphQL(name: "posts", batch: true)\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Make sure you have also specified batch settings to the ",(0,i.jsx)(n.code,{children:"@upstream"})," and to the ",(0,i.jsx)(n.code,{children:"@graphQL"})," directive."]}),"\n",(0,i.jsx)(n.h2,{id:"grpc-directive",children:"@grpc Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@grpc"})," directive enables the resolution of GraphQL fields via gRPC services. Below is an illustrative example of how to apply this directive within a GraphQL schema:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema @link(src: "./users.proto", type: Protobuf) {\n  query: Query\n}\n\ntype Query {\n  users: [User] @grpc(method: "users.UserService.ListUsers")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This schema snippet demonstrates the directive's application, where a query for ",(0,i.jsx)(n.code,{children:"users"})," triggers a gRPC request to the ",(0,i.jsx)(n.code,{children:"UserService"}),"'s ",(0,i.jsx)(n.code,{children:"ListUsers"})," method, thereby fetching the user data."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:".proto"})," file delineates the structure and methods of the gRPC service. A simplified example of such a file is as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-proto",children:'syntax = "proto3";\n\npackage users;\n\nservice UserService {\n  rpc ListUsers (UserListRequest) returns (UserListReply) {}\n  rpc GetUser (UserGetRequest) returns (UserGetReply) {}\n}\n\nmessage UserListRequest {\n  // Definitions of request parameters\n}\n\nmessage UserListReply {\n  // Structure of the reply\n}\n\nmessage UserGetRequest {\n  // Definitions of request parameters\n}\n\nmessage UserGetReply {\n  // Structure of the reply\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsx)(n.p,{children:"It is mandatory to have a package name in a protobuf file."})}),"\n",(0,i.jsxs)(n.p,{children:["Linking this file within a GraphQL schema is facilitated by the ",(0,i.jsx)(n.code,{children:"@link"})," directive, as shown below:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema @link(src: "./users.proto", type: Protobuf) {\n  query: Query\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Tailcall automatically resolves the protobuf file for any methods referenced in the ",(0,i.jsx)(n.code,{children:"@grpc"})," directive."]}),"\n",(0,i.jsx)(n.h3,{id:"method",children:"method"}),"\n",(0,i.jsxs)(n.p,{children:["This parameter specifies the gRPC service and method to be invoked, formatted as ",(0,i.jsx)(n.code,{children:"<package>.<service>.<method>"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  users: [User]\n    @grpc(method: "proto.users.UserService.ListUsers")\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"baseurl-1",children:"baseURL"}),"\n",(0,i.jsxs)(n.p,{children:["Defines the base URL for the gRPC API. If not specified, the URL set in the ",(0,i.jsx)(n.code,{children:"@upstream"})," directive is used by default:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  users: [User]\n    @grpc(\n      baseURL: "https://grpc-server.example.com"\n      method: "proto.users.UserService.ListUsers"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"body",children:"body"}),"\n",(0,i.jsx)(n.p,{children:"This parameter outlines the arguments for the gRPC call, allowing for both static and dynamic inputs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type UserInput {\n  id: ID\n}\n\ntype Query {\n  user(id: UserInput!): User\n    @grpc(\n      body: "{{.args.id}}"\n      method: "proto.users.UserService.GetUser"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"headers-1",children:"headers"}),"\n",(0,i.jsx)(n.p,{children:"Custom headers for the gRPC request can be defined, facilitating the transmission of authentication tokens or other contextual data:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  users: [User]\n    @grpc(\n      headers: [\n        {key: "X-CUSTOM-HEADER", value: "custom-value"}\n      ]\n      method: "proto.users.UserService.ListUsers"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"batchkey",children:"batchKey"}),"\n",(0,i.jsx)(n.p,{children:"This argument is employed to optimize batch requests by grouping them based on specified response keys, enhancing performance in scenarios requiring multiple, similar requests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type Query {\n  users(id: UserInput!): [User]\n    @grpc(\n      batchKey: ["id"]\n      method: "proto.users.UserService.ListUsers"\n      baseURL: "https://grpc-server.example.com"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Read about ",(0,i.jsx)(n.a,{href:"/docs/graphql-n-plus-one-problem-solved-tailcall",children:"n + 1"})," to learn how to use the ",(0,i.jsx)(n.code,{children:"batchKey"})," setting."]})}),"\n",(0,i.jsx)(n.h3,{id:"onresponsebody",children:"onResponseBody"}),"\n",(0,i.jsxs)(n.p,{children:["This hook allows you to intercept and modify the response body from upstream services before it's processed by Tailcall. Like ",(0,i.jsx)(n.a,{href:"/docs/tailcall-dsl-graphql-custom-directives#onrequest",children:"onRequest"}),", it accepts a string value representing a middleware function defined in a JavaScript file. This function can be used to transform or validate the response data."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  news: NewsData!\n    @grpc(\n      method: "news.NewsService.GetAllNews"\n      onResponseBody: "onResponse"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"select",children:"select"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"select"})," with mustache syntax to re-construct the directives\nresponse to the desired format. This is useful when data are deeply\nnested or want to keep specific fields only from the response."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["EXAMPLE 1: if we have a call that returns ",(0,i.jsx)(n.code,{children:'{ "user": { "items": [...], ... } ... }'})," we can use ",(0,i.jsx)(n.code,{children:'"{{.user.items}}"'}),", to extract the ",(0,i.jsx)(n.code,{children:"items"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["EXAMPLE 2: if we have a call that returns ",(0,i.jsx)(n.code,{children:'{ "foo": "bar", "fizz": { "buzz": "eggs", ... }, ... }'})," we can use ",(0,i.jsx)(n.code,{children:'{ foo: "{{.foo}}", buzz: "{{.fizz.buzz}}" }'})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  userCompany(id: Int!): Company\n    @grpc(\n      method: "news.UsersService.GetUserDetails"\n      select: "{{.company}}"\n    )\n  userDetails(id: Int!): UserDetails\n    @grpc(\n      method: "news.UsersService.GetUserDetails"\n      select: {\n        id: "{{.id}}"\n        city: "{{.address.city}}"\n        phone: "{{.phone}}"\n      }\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"http-directive",children:"@http Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@http"})," directive indicates a field or node relies on a REST API. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  users: [User] @http(path: "/users")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, adding the ",(0,i.jsx)(n.code,{children:"@http"})," directive to the ",(0,i.jsx)(n.code,{children:"users"})," field of the ",(0,i.jsx)(n.code,{children:"Query"})," type indicates reliance on a REST API for the ",(0,i.jsx)(n.code,{children:"users"})," field. The ",(0,i.jsx)(n.a,{href:"#path",children:"path"})," argument specifies the REST API's path, which is ",(0,i.jsx)(n.code,{children:"/users"})," in this scenario.Querying the ",(0,i.jsx)(n.code,{children:"users"})," field prompts the GraphQL server to issue a GET request to ",(0,i.jsx)(n.code,{children:"https://jsonplaceholder.typicode.com/users"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"baseurl-2",children:"baseURL"}),"\n",(0,i.jsxs)(n.p,{children:["Specifies the API's base URL. If unspecified, it defaults to the URL in the ",(0,i.jsx)(n.a,{href:"#upstream-directive",children:(0,i.jsx)(n.code,{children:"@upstream"})})," directive."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  users: [User]\n    @http(\n      path: "/users"\n      baseURL: "https://jsonplaceholder.typicode.com"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"path",children:"path"}),"\n",(0,i.jsxs)(n.p,{children:["Refers to the API endpoint, for example, ",(0,i.jsx)(n.code,{children:"https://jsonplaceholder.typicode.com/users"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  users: [User] @http(path: "/users")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If your API endpoint contains dynamic segments, you can substitute variables using Mustache templates. For example, to fetch a specific user, you can write the path as ",(0,i.jsx)(n.code,{children:"/users/{{.args.id}}"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  user(id: ID!): User @http(path: "/users/{{.args.id}}")\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"method-1",children:"method"}),"\n",(0,i.jsx)(n.p,{children:"Specifies the HTTP method for the API call. The default method is GET if not specified."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Mutation {\n  createUser(input: UserInput!): User\n    @http(method: "POST", path: "/users")\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"query-1",children:"query"}),"\n",(0,i.jsx)(n.p,{children:"Represents the API call's query parameters, either as a static object or with dynamic parameters using Mustache templates. These parameters append to the URL."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  userPosts(id: ID!): [Post]\n    @http(\n      path: "/posts"\n      query: [\n        {\n          key: "userId"\n          value: "{{.args.id}}"\n          skipEmpty: false\n        }\n      ]\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"query"})," field and be further configured using the following fields:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"key"})," : Represents the name of the query parameter."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"value"})," : A string literal or a mustache template representing the value of query parameter."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"skipEmpty"})," : When set to ",(0,i.jsx)(n.code,{children:"true"})," the query parameter is skipped if the value of the parameter is null, defaults to false."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:["When ",(0,i.jsx)(n.code,{children:"batchKey"})," is present, Tailcall considers the first ",(0,i.jsx)(n.code,{children:"query"})," parameter to be the batch query key, so remember to adjust the order of the items accordingly."]})}),"\n",(0,i.jsx)(n.h3,{id:"body-1",children:"body"}),"\n",(0,i.jsx)(n.p,{children:"Defines the API call's body, necessary for methods like POST or PUT. Pass it as a static object or use Mustache templates for variable substitution from the GraphQL variables."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Mutation {\n  createUser(input: UserInput!): User\n    @http(\n      method: "POST"\n      path: "/users"\n      body: "{{.args.input}}"\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In the example above, the ",(0,i.jsx)(n.code,{children:"createUser"})," mutation sends a POST request to ",(0,i.jsx)(n.code,{children:"/users"}),", with the input object converted to JSON and included in the request body."]}),"\n",(0,i.jsx)(n.h3,{id:"headers-2",children:"headers"}),"\n",(0,i.jsxs)(n.p,{children:["Customizes the HTTP request headers made by the ",(0,i.jsx)(n.code,{children:"@http"})," directive. Specify a key-value map of header names and values."]}),"\n",(0,i.jsx)(n.p,{children:"For instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Mutation {\n  createUser(input: UserInput!): User\n    @http(\n      path: "/users"\n      headers: [{key: "X-Server", value: "Tailcall"}]\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, a request to ",(0,i.jsx)(n.code,{children:"/users"})," will include a HTTP header ",(0,i.jsx)(n.code,{children:"X-Server"})," with the value ",(0,i.jsx)(n.code,{children:"Tailcall"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["You can make use of mustache templates to provide dynamic values for headers, derived from the arguments or ",(0,i.jsx)(n.a,{href:"/docs/graphql-resolver-context-tailcall",children:"context"})," provided in the request. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Mutation {\n  users(name: String): User\n    @http(\n      path: "/users"\n      headers: [\n        {key: "X-Server", value: "Tailcall"}\n        {key: "User-Name", value: "{{.args.name}}"}\n      ]\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this scenario, the ",(0,i.jsx)(n.code,{children:"User-Name"})," header's value will dynamically adjust according to the ",(0,i.jsx)(n.code,{children:"name"})," argument passed in the request."]}),"\n",(0,i.jsx)(n.h3,{id:"batchkey-1",children:"batchKey"}),"\n",(0,i.jsxs)(n.p,{children:["Groups data requests into a single call, enhancing efficiency. Refer to our ",(0,i.jsx)(n.a,{href:"/docs/graphql-n-plus-one-problem-solved-tailcall",children:"n + 1 guide"})," for more details."]}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:["When ",(0,i.jsx)(n.code,{children:"batchKey"})," is present, Tailcall considers the first ",(0,i.jsx)(n.code,{children:"query"})," parameter to be the batch query key, so remember to adjust the order of the items accordingly. Whereas, the last item from ",(0,i.jsx)(n.code,{children:"batchKey"})," is used to instruct which field is the ID of an object. In case that the returned result is a nested property ",(0,i.jsx)(n.code,{children:"batchKey"})," can be used as a path to extract and group the items for the returned result."]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Post {\n  id: Int!\n  name: String!\n  user: User\n    @http(\n      path: "/users"\n      query: [{key: "user_id", value: "{{.value.userId}}"}]\n      batchKey: ["users", "id"]\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'query: {key: "user_id", value: "{{.value.userId}}"}]'}),": Instructs Tailcall CLI to generate a URL aligning the user id with ",(0,i.jsx)(n.code,{children:"userId"})," from the parent ",(0,i.jsx)(n.code,{children:"Post"}),", compiling a single URL for a batch of posts, such as ",(0,i.jsx)(n.code,{children:"/users?user_id=1&user_id=2&user_id=3...user_id=10"}),", consolidating requests into one."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"onrequest",children:"onRequest"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"onRequest"})," property accepts a string value representing the remote function to be called every time an HTTP request is initiated. Typically the remote function is defined in a linked JavaScript worker file."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["For defining a request middleware globally for all requests, refer to the ",(0,i.jsx)(n.a,{href:"/docs/tailcall-dsl-graphql-custom-directives#onrequest-1",children:"upstream directive documentation"}),"."]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  userPosts(id: ID!): [Post]\n    @http(\n      path: "/posts"\n      query: [{key: "userId", value: "{{.args.id}}"}]\n      onRequest: "someFunctionName"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onresponsebody-1",children:"onResponseBody"}),"\n",(0,i.jsxs)(n.p,{children:["This hook allows you to intercept and modify the response body from upstream services before it's processed by Tailcall. Like ",(0,i.jsx)(n.a,{href:"/docs/tailcall-dsl-graphql-custom-directives#onrequest",children:"onRequest"}),", it accepts a string value representing a middleware function defined in a JavaScript file. This function can be used to transform or validate the response data."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  user(id: Int!): User\n    @http(\n      path: "/users/{{.args.id}}"\n      onResponseBody: "onResponse"\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"select-1",children:"select"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"select"})," with mustache syntax to re-construct the directives\nresponse to the desired format. This is useful when data are deeply\nnested or want to keep specific fields only from the response."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["EXAMPLE 1: if we have a call that returns ",(0,i.jsx)(n.code,{children:'{ "user": { "items": [...], ... } ... }'})," we can use ",(0,i.jsx)(n.code,{children:'"{{.user.items}}"'}),", to extract the ",(0,i.jsx)(n.code,{children:"items"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["EXAMPLE 2: if we have a call that returns ",(0,i.jsx)(n.code,{children:'{ "foo": "bar", "fizz": { "buzz": "eggs", ... }, ... }'})," we can use ",(0,i.jsx)(n.code,{children:'{ foo: "{{.foo}}", buzz: "{{.fizz.buzz}}" }'})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type Query {\n  userCompany(id: Int!): Company\n    @http(\n      path: "/users/{{.args.id}}"\n      select: "{{.company}}"\n    )\n  userDetails(id: Int!): UserDetails\n    @http(\n      path: "/users/{{.args.id}}"\n      select: {\n        id: "{{.id}}"\n        city: "{{.address.city}}"\n        phone: "{{.phone}}"\n      }\n    )\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"js-directive",children:"@js Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@js"})," directive allows you to use JavaScript functions to resolve fields in your GraphQL schema. This can be useful\nfor custom data transformations or complex field resolutions."]}),"\n",(0,i.jsx)(n.h3,{id:"usage-1",children:"Usage"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@js"})," directive is used to specify a JavaScript function that will resolve the value of a field. The directive takes\na single argument, ",(0,i.jsx)(n.code,{children:"name"}),", which is the name of the JavaScript function to be used."]}),"\n",(0,i.jsx)(n.h3,{id:"syntax",children:"Syntax"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'fieldName: FieldType @js(name: "functionName")\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["Let's consider a ",(0,i.jsx)(n.code,{children:"foo.js"})," file which contains a ",(0,i.jsx)(n.code,{children:"resolve"})," function:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"function resolve(val) {\n  let json = JSON.parse(val)\n  return JSON.stringify(json.id)\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Here is an example of how the ",(0,i.jsx)(n.code,{children:"@js"})," directive is used within a GraphQL schema:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gql",metastring:"showLineNumbers",children:'schema\n  @link(type: Script, src: "./scripts/foo.js")\n  @server(port: 8000)\n  @upstream(\n    baseURL: "http://jsonplaceholder.typicode.com"\n    httpCache: true\n  ) {\n  query: Query\n}\n\ntype Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int!\n  idx: Int! @js(name: "resolve")\n  userId: Int!\n  title: String!\n  body: String!\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsxs)(n.p,{children:["When using the ",(0,i.jsx)(n.code,{children:"@js"})," directive, it is important to handle errors within your JavaScript functions. For example, you can use try-catch blocks to catch and handle any errors that occur during the resolution process."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'function resolve(val) {\n  try {\n    let json = JSON.parse(val)\n    return JSON.stringify(json.id)\n  } catch (error) {\n    console.error("Error resolving value:", error)\n    throw new Error("Failed to resolve value")\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,i.jsxs)(n.p,{children:["When using the ",(0,i.jsx)(n.code,{children:"@js"})," directive, keep in mind that JavaScript functions can introduce performance overhead, especially if they perform complex operations or are called frequently. To minimize performance impact, ensure that your functions are optimized and avoid unnecessary computations."]}),"\n",(0,i.jsx)(n.h2,{id:"link-directive",children:"@link Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@link"})," directive is used for bringing external resources into your GraphQL schema. It makes it easier to include configurations, .proto files for gRPC services, and other files into your schema. With this directive, external resources are either merged with or used effectively in the importing configuration."]}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works",children:"How it Works"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@link"})," directive requires specifying a source ",(0,i.jsx)(n.code,{children:"src"}),", the resource's type ",(0,i.jsx)(n.code,{children:"type"}),", and an optional identifier ",(0,i.jsx)(n.code,{children:"id"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"src"}),": The source of the link is defined here. It can be either a URL or a file path. When a file path is given, it's relative to the file's location that is importing the link."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"type"}),": This specifies the link's type, which determines how the imported resource is integrated into the schema. For a list of supported types, see the ",(0,i.jsx)(n.a,{href:"#supported-types",children:"Supported Types"})," section."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"id"}),": This is an optional field that assigns a unique identifier to the link. It's helpful for referring to the link within the schema."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"headers"}),": This is an optional field that assigns custom headers to the gRPC reflection server requests. Specifying a key-value map of header names and their values achieves this."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-1",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["The following example illustrates how to utilize the ",(0,i.jsx)(n.code,{children:"@link"})," directive to incorporate a Protocol Buffers (.proto) file for a gRPC service into your GraphQL schema."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @server(port: 8000)\n  @upstream(\n    baseURL: "http://news.local"\n    httpCache: 42\n    batch: {delay: 10}\n  )\n  @link(\n    id: "news"\n    src: "./src/grpc/news.proto"\n    type: Protobuf\n    headers: [{key: "authorization", value: "Bearer 123"}]\n  ) {\n  query: Query\n}\n\ntype Query {\n  news: NewsData!\n    @grpc(method: "news.NewsService.GetAllNews")\n}\n\ntype News {\n  id: Int\n  title: String\n  body: String\n  postImage: String\n}\n\ntype NewsData {\n  news: [News]!\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"supported-types",children:"Supported Types"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@link"})," directive enriches your configuration by supporting the integration of external resources. Each link type is designed to serve a specific purpose, enhancing the functionality and flexibility of your schema. Below is a detailed overview of each supported link type:"]}),"\n",(0,i.jsx)(n.h3,{id:"config",children:"Config"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Config"})," link type is essential for importing other configuration files. This feature enables a modular approach to schema management by allowing configurations from the imported file to override overlapping settings in the main schema. This functionality is useful in large projects, where maintaining a single monolithic schema file becomes impractical. By using ",(0,i.jsx)(n.code,{children:"Config"}),", developers can split their schema configurations into manageable pieces, thus promoting better organization and scalability."]}),"\n",(0,i.jsx)(n.p,{children:"Example use case:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Modularizing schema configurations for different environments (development, staging, production)."}),"\n",(0,i.jsx)(n.li,{children:"Reusing common configurations across multiple schema files."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"protobuf",children:"Protobuf"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Protobuf"})," link type integrates Protocol Buffers definitions by importing .proto files. This integration is crucial for Tailcall to communicate with gRPC services. By including ",(0,i.jsx)(n.code,{children:".proto"})," definitions, the GraphQL server can directly interact with gRPC services, allowing for efficient and type-safe communication."]}),"\n",(0,i.jsxs)(n.p,{children:["For detailed integration steps and best practices, refer to the ",(0,i.jsx)(n.a,{href:"/docs/graphql-grpc-tailcall",children:"gRPC Integration Guide"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"script",children:"Script"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Script"})," link type allows the config to link to an external JavaScript file. This file can contain custom logic that is executed in response to HTTP request-response events. This feature enables developers to implement custom behaviors, such as adding headers to responses or filtering requests based on specific criteria."]}),"\n",(0,i.jsx)(n.p,{children:"Example script for adding a custom header to all outgoing requests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:"showLineNumbers",children:'function onRequest({request}) {\n  // Add a custom header for all outgoing requests\n  request.headers["X-Custom-Header"] = "Processed"\n\n  // Return the updated request\n  return {request}\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"cert",children:"Cert"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Cert"})," link type is designed for importing SSL/TLS certificates, a crucial component for enabling HTTPS in your GraphQL server. This link type ensures that the server can expose connections over HTTPS."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["When using the ",(0,i.jsx)(n.code,{children:"Cert"})," link type, specify the path to the certificate file. Ensure the certificate is up-to-date and issued by a trusted certificate authority (CA) to avoid security warnings or connection issues."]})}),"\n",(0,i.jsx)(n.p,{children:"Example use case:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Securing communication between the GraphQL server and clients."}),"\n",(0,i.jsx)(n.li,{children:"Enhancing privacy and security by encrypting data in transit."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"key",children:"Key"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Key"})," link type imports the private key associated with your SSL/TLS certificate, enabling HTTPS for your GraphQL server. The private key is a critical security element that decrypts information encrypted by the corresponding public key in the SSL/TLS certificate."]}),"\n",(0,i.jsxs)(n.p,{children:["When configuring the ",(0,i.jsx)(n.code,{children:"Key"})," link type, provide the path to your private key file. Ensure the private key matches the imported certificate specified by the ",(0,i.jsx)(n.a,{href:"#cert",children:"Cert"})," link above, and is protected by appropriate file permissions to maintain security."]}),"\n",(0,i.jsx)(n.h3,{id:"operation",children:"Operation"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Operation"})," link type connects your schema to a set of predefined, GraphQL spec-compliant queries and mutations. This functionality allows for the validation and optimization of these operations by the GraphQL server."]}),"\n",(0,i.jsx)(n.p,{children:"Each type serves a specific purpose, enabling the flexible integration of external resources into your GraphQL schema."}),"\n",(0,i.jsx)(n.h3,{id:"htpasswd",children:"Htpasswd"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Htpasswd"})," link type allows the importation of an ",(0,i.jsx)(n.a,{href:"https://httpd.apache.org/docs/2.4/programs/htpasswd.html",children:(0,i.jsx)(n.code,{children:"htpasswd"})})," file. This file is utilized to set up ",(0,i.jsx)(n.a,{href:"/docs/field-level-access-control-graphql-authentication#basic-authentication",children:"Basic authentication"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"jwks",children:"Jwks"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Jwks"})," link type enables the importation of a ",(0,i.jsx)(n.a,{href:"https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-key-sets",children:(0,i.jsx)(n.code,{children:"JWKS"})})," file. This file facilitates the provision of detailed access control through ",(0,i.jsx)(n.a,{href:"/docs/field-level-access-control-graphql-authentication#jwt-authentication",children:"JWT authentication"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"modify-directive",children:"@modify Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@modify"})," directive in GraphQL provides the flexibility to alter the attributes of a field or a node within your GraphQL schema. Here's how you can use this directive:"]}),"\n",(0,i.jsx)(n.h3,{id:"name-1",children:"name"}),"\n",(0,i.jsxs)(n.p,{children:["You can rename a field or a node in your GraphQL schema using the ",(0,i.jsx)(n.code,{children:"name"})," argument in the ",(0,i.jsx)(n.code,{children:"@modify"})," directive. This can be helpful when the field name in your underlying data source doesn't match the desired field name in your schema. For instance:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'type User {\n  id: Int! @modify(name: "userId")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:'@modify(name: "userId")'})," informs GraphQL to present the field known as ",(0,i.jsx)(n.code,{children:"id"})," in the underlying data source as ",(0,i.jsx)(n.code,{children:"userId"})," in your schema."]}),"\n",(0,i.jsx)(n.h3,{id:"omit",children:"omit"}),"\n",(0,i.jsxs)(n.p,{children:["You can exclude a field or a node from your GraphQL schema using the ",(0,i.jsx)(n.code,{children:"omit"})," argument in the ",(0,i.jsx)(n.code,{children:"@modify"})," directive. This can be useful if you want to keep certain data hidden from the client. For instance:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"type User {\n  id: Int! @modify(omit: true)\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@modify(omit: true)"})," instructs GraphQL to exclude the ",(0,i.jsx)(n.code,{children:"id"})," field from the schema, making it inaccessible to the client."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@omit"})," is a standalone directive and is an alias/shorthand for ",(0,i.jsx)(n.code,{children:"modify(omit: true)"})," checkout ",(0,i.jsx)(n.a,{href:"/docs/tailcall-dsl-graphql-custom-directives#omit-directive",children:"documentation"})]})}),"\n",(0,i.jsx)(n.h2,{id:"omit-directive",children:"@omit Directive"}),"\n",(0,i.jsxs)(n.p,{children:["Within a GraphQL schema, the ",(0,i.jsx)(n.code,{children:"@omit"})," directive excludes fields or nodes from the generated schema, making them inaccessible through the GraphQL API. This directive is useful for hiding sensitive information or simplifying your API by removing unnecessary fields."]}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works-1",children:"How it works"}),"\n",(0,i.jsxs)(n.p,{children:["When applied to a field or node, the ",(0,i.jsx)(n.code,{children:"@omit"})," directive instructs the Tailcall not to include that field or node in the schema. This means that clients cannot query or mutate data in those fields."]}),"\n",(0,i.jsx)(n.h3,{id:"example-2",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["Consider a scenario where you have a ",(0,i.jsx)(n.code,{children:"User"})," type with an embedded ",(0,i.jsx)(n.code,{children:"Address"})," type. If you want to exclude the ",(0,i.jsx)(n.code,{children:"Address"})," type from the schema to simplify the API, you can use the ",(0,i.jsx)(n.code,{children:"@omit"})," directive:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"type Address {\n  city: String\n  street: String\n}\n\ntype User {\n  name: String\n  address: Address @omit\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the ",(0,i.jsx)(n.code,{children:"address"})," field will not be accessible or visible through the GraphQL API."]}),"\n",(0,i.jsxs)(n.h3,{id:"comparison-with-modify",children:["Comparison with ",(0,i.jsx)(n.code,{children:"modify"})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@omit"})," directive and ",(0,i.jsx)(n.code,{children:"@modify(omit: true)"})," essentially serve the same purpose in excluding fields from the schema, but they differ in syntax and flexibility. In fact, one can consider ",(0,i.jsx)(n.code,{children:"@omit"})," as a shorthand or alias for the more verbose ",(0,i.jsx)(n.code,{children:"@modify(omit: true)"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@omit"})," offers a concise way to directly exclude a field or node without additional arguments."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"@modify(omit: true)"}),", as part of the broader ",(0,i.jsx)(n.a,{href:"/docs/tailcall-dsl-graphql-custom-directives#omit-directive",children:(0,i.jsx)(n.code,{children:"@modify"})})," directive, provides more options, such as field renaming through the ",(0,i.jsx)(n.code,{children:"name"})," argument. This makes it a more flexible choice when you need more than field exclusion."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"protected-directive",children:"@protected Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@protected"})," annotation designates a type or field as protected, meaning that a user must be authenticated to access that data."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"type Query {\n  protected: String! @protected\n  protectedType: ProtectedType\n}\n\ntype ProtectedType @protected {\n  name: String!\n  nested: String!\n}\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:["To utilize the ",(0,i.jsx)(n.code,{children:"@protected"})," directive, you must link at least one authentication provider in the configuration using the ",(0,i.jsx)(n.a,{href:"#link-directive",children:(0,i.jsx)(n.code,{children:"@link"})})," directive (",(0,i.jsx)(n.code,{children:"Htpasswd"})," or ",(0,i.jsx)(n.code,{children:"Jwks"}),")."]})}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works-2",children:"How It Works"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["When a field is annotated with ",(0,i.jsx)(n.code,{children:"@protected"}),", an authentication check is performed upon receiving the request. Depending on the authentication result, either the requested data is provided in the response, or an authentication error is returned."]}),"\n",(0,i.jsxs)(n.li,{children:["If a type is annotated with ",(0,i.jsx)(n.code,{children:"@protected"}),", all fields within that type inherit the protection, requiring user authentication for any field that's queried."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"rest-directive",children:"@rest Directive"}),"\n",(0,i.jsx)(n.p,{children:"API orchestration is essential, yet not all can adopt GraphQL despite its benefits. The Tailcall DSL feature leverages GraphQL at compile time to generate REST endpoints, aligning with traditional API infrastructure like CDNs and Gateways."}),"\n",(0,i.jsx)(n.h3,{id:"usage-2",children:"Usage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"method"}),": Specifies the HTTP method (GET, POST, etc.)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"path"}),": Sets the endpoint URL, with support for dynamic values from query arguments."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"query"}),": Defines the query parameters as key-value pairs."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-3",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["Define GraphQL types and queries, using the ",(0,i.jsx)(n.code,{children:"@rest"})," directive to map fields to REST API endpoints."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"schema.graphql"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema\n  @upstream(baseURL: "https://jsonplaceholder.typicode.com")\n  @link(type: Operation, src: "user-operation.graphql") {\n  query: Query\n}\n\ntype Query {\n  user(id: Int!): User\n    @rest(method: "GET", path: "/users/{{.args.id}}")\n}\n\ntype User {\n  id: Int!\n  name: String!\n  email: String!\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"user-operation.graphql"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'query ($id: Int!) @rest(method: GET, path: "/user/$id") {\n  user(id: $id) {\n    id\n    name\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"REST Demo",src:s(21400).A+"",width:"2992",height:"1686"})}),"\n",(0,i.jsxs)(n.p,{children:["This example demonstrates how to define a simple query to fetch user data from a REST endpoint using the ",(0,i.jsx)(n.code,{children:"@rest"})," directive. By leveraging ",(0,i.jsx)(n.code,{children:"@rest"}),", GraphQL can serve as a layer over RESTful services, combining REST's simplicity with GraphQL's flexibility."]}),"\n",(0,i.jsx)(n.h2,{id:"server-directive",children:"@server Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@server"})," directive, applied at the schema level, provides a comprehensive set of server configurations. It dictates server behavior and helps tune Tailcall for a range of use-cases."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(...[ServerSettings]...){\n    query: Query\n    mutation: Mutation\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this templated structure, replace ",(0,i.jsx)(n.code,{children:"...[ServerSettings]..."})," with specific configurations tailored to your project's needs. Adjust and expand these settings as necessary."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ServerSettings"})," options and their details appear below."]}),"\n",(0,i.jsx)(n.h3,{id:"workers",children:"workers"}),"\n",(0,i.jsxs)(n.p,{children:["Setting ",(0,i.jsx)(n.code,{children:"workers"})," to ",(0,i.jsx)(n.code,{children:"32"})," means that the GraphQL server will use 32 worker threads."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(workers: 32) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This example sets the ",(0,i.jsx)(n.code,{children:"workers"})," to ",(0,i.jsx)(n.code,{children:"32"}),", meaning the GraphQL server will use 32 worker threads."]}),"\n",(0,i.jsx)(n.h3,{id:"port",children:"port"}),"\n",(0,i.jsxs)(n.p,{children:["Setting the ",(0,i.jsx)(n.code,{children:"port"})," to ",(0,i.jsx)(n.code,{children:"8090"})," means that Tailcall will be accessible at ",(0,i.jsx)(n.code,{children:"http://localhost:8000"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(port: 8090) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This example sets the ",(0,i.jsx)(n.code,{children:"port"})," to ",(0,i.jsx)(n.code,{children:"8090"}),", making Tailcall accessible at ",(0,i.jsx)(n.code,{children:"http://localhost:8090"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Always choose non-standard ports, avoiding typical ones like 80 or 8080. Make sure your chosen port is free."})}),"\n",(0,i.jsx)(n.h3,{id:"headers-3",children:"headers"}),"\n",(0,i.jsx)(n.p,{children:"Allows intelligent configuration of the final response headers that's produced by Tailcall."}),"\n",(0,i.jsx)(n.h3,{id:"cachecontrol",children:"cacheControl"}),"\n",(0,i.jsxs)(n.p,{children:["Activating the ",(0,i.jsx)(n.code,{children:"cacheControl"})," configuration directs Tailcall to send ",(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control",children:"Cache-Control"})," headers in its responses. The ",(0,i.jsx)(n.code,{children:"max-age"})," value in the header matches the lowest of the values in the responses that Tailcall receives from its upstream. By default, this is ",(0,i.jsx)(n.code,{children:"false"}),", which means Tailcall does not set any header."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(headers: {cacheControl: true}) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"custom",children:"custom"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"custom"})," is an array of key-value pairs. These headers get added to the response of every request made to the server. This can be useful for adding headers like ",(0,i.jsx)(n.code,{children:"Access-Control-Allow-Origin"})," to allow cross-origin requests, or some headers like ",(0,i.jsx)(n.code,{children:"X-Allowed-Roles"})," for use by downstream services."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @server(\n    headers: {\n      custom: [\n        {key: "X-Allowed-Roles", value: "admin,user"}\n      ]\n    }\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"experimental",children:"experimental"}),"\n",(0,i.jsxs)(n.p,{children:["When the ",(0,i.jsx)(n.code,{children:"experimental"})," configuration is enabled, Tailcall can include headers starting with ",(0,i.jsx)(n.code,{children:"X-"})," in its responses, which are sourced from its upstream. By default, this feature is disabled (",(0,i.jsx)(n.code,{children:"[]"}),"), meaning Tailcall does not forward any such headers unless explicitly configured to do so."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @server(\n    headers: {experimental: ["X-Experimental-Header"]}\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setcookies",children:"setCookies"}),"\n",(0,i.jsxs)(n.p,{children:["Enabling the ",(0,i.jsx)(n.code,{children:"setCookies"})," option instructs Tailcall to include ",(0,i.jsx)(n.code,{children:"set-cookie"})," headers in its responses, which are obtained from the headers of upstream responses."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(headers: {setCookies: true}) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"cors",children:"cors"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"cors"})," configuration allows you to enable ",(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",children:"CORS"})," on Tailcall. This is useful when you want to access Tailcall in the browser. Here is a simple configuration to get started with cors:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @server(\n    headers: {\n      cors: {allowHeaders: ["*"], allowOrigins: ["*"]}\n    }\n  ) {\n  query: Query\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"The above setting will enable CORS on the server for all headers, origins & methods. You can further configure the cors settings to make it more secure with the following fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowCredentials"}),": Indicates whether the server allows credentials (e.g., cookies, authorization headers) to be sent in cross-origin requests."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowHeaders"}),": A list of allowed headers in cross-origin requests. This can be used to specify custom headers that are allowed to be included in cross-origin requests."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowMethods"}),": A list of allowed HTTP methods in cross-origin requests. These methods specify the actions that are permitted in cross-origin requests."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowOrigins"}),": A list of origins that are allowed to access the server's resources in cross-origin requests. An origin can be a domain, a subdomain, or even 'null' for local file schemes."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowPrivateNetwork"}),": Indicates whether requests from private network addresses are allowed in cross-origin requests. Private network addresses typically include IP addresses reserved for internal networks."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"exposeHeaders"}),": A list of headers that the server exposes to the browser in cross-origin responses. Exposing certain headers allows client-side code to access them in the response."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"maxAge"}),": The maximum time (in seconds) that the client should cache preflight OPTIONS requests to avoid sending excessive requests to the server."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"vary"}),": A list of header names that indicate the values of which might cause the server's response to vary, potentially affecting caching."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @server(\n    port: 8000\n    hostname: "0.0.0.0"\n    headers: {\n      cors: {\n        allowCredentials: false\n        allowHeaders: ["Authorization"]\n        allowMethods: [POST, GET, OPTIONS]\n        allowOrigins: ["abc.xyz"]\n        allowPrivateNetwork: true\n        exposeHeaders: ["Content-Type"]\n        maxAge: 360\n        vary: ["Origin"]\n      }\n    }\n  ) {\n  query: Query\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"vars",children:"vars"}),"\n",(0,i.jsx)(n.p,{children:"This configuration allows defining local variables for use during the server's operations. These variables are handy for storing constant configurations, secrets, or other shared information that operations might need."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @server(\n    vars: {key: "apiKey", value: "YOUR_API_KEY_HERE"}\n  ) {\n  query: Query\n  mutation: Mutation\n}\n\ntype Query {\n  externalData: Data\n    @http(\n      path: "/external-api/data"\n      headers: [\n        {\n          key: "Authorization"\n          value: "Bearer {{.vars.apiKey}}"\n        }\n      ]\n    )\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In the provided example, setting a variable named ",(0,i.jsx)(n.code,{children:"apiKey"}),' with a placeholder value of "YOUR_API_KEY_HERE" implies that whenever Tailcall fetches data from the ',(0,i.jsx)(n.code,{children:"externalData"})," endpoint, it includes the ",(0,i.jsx)(n.code,{children:"apiKey"})," in the Authorization header of the HTTP request."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Local variables, like ",(0,i.jsx)(n.code,{children:"apiKey"}),", are instrumental in securing access to external services or providing a unified place for configurations. Ensure that sensitive information stored this way is well protected and not exposed unintentionally, if your GraphQL configuration is publicly accessible."]})}),"\n",(0,i.jsx)(n.h3,{id:"introspection",children:"introspection"}),"\n",(0,i.jsxs)(n.p,{children:["This setting controls the server's allowance of introspection queries. Introspection, a core feature of GraphQL, allows clients to directly fetch schema information. This capability proves crucial for tools and client applications in comprehending the available types, fields, and operations. By default, the server enables this setting (",(0,i.jsx)(n.code,{children:"true"}),")."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(introspection: false) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Although introspection is beneficial during development and debugging stages, consider disabling it in production environments. Turning off introspection in live deployments can enhance security by preventing potential attackers from discerning the schema and any associated business logic or data structures."})}),"\n",(0,i.jsx)(n.h3,{id:"queryvalidation",children:"queryValidation"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"queryValidation"})," configuration determines if the server checks incoming GraphQL queries against the defined schema. Each query check ensures it matches the schema, preventing errors from incorrect or malformed queries. In some situations, you might want to disable it, notably to ",(0,i.jsx)(n.strong,{children:"enhance server performance"})," at the cost of these checks. This defaults to ",(0,i.jsx)(n.code,{children:"false"})," if not specified."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(queryValidation: true) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The example above sets ",(0,i.jsx)(n.code,{children:"queryValidation"})," to ",(0,i.jsx)(n.code,{children:"true"}),", enabling the validation phase for incoming queries."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Enable this in the development environment to ensure the queries sent are correct and validated. In the production environment, consider disabling it for improved performance."})}),"\n",(0,i.jsx)(n.h3,{id:"responsevalidation",children:"responseValidation"}),"\n",(0,i.jsxs)(n.p,{children:["Tailcall can automatically infer the schema of the HTTP endpoints for you. This information can check responses received from the upstream services. Enabling this setting allows you to do that. If not specified, the default setting for ",(0,i.jsx)(n.code,{children:"responseValidation"})," is ",(0,i.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(responseValidation: true) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Disabling this setting will offer major performance improvements, but at the potential expense of data integrity."})}),"\n",(0,i.jsx)(n.h3,{id:"globalresponsetimeout",children:"globalResponseTimeout"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"globalResponseTimeout"})," configuration sets the max duration a query can run before the server terminates it. Essentially, it acts as a safeguard against long-running queries that could strain resources or pose security concerns."]}),"\n",(0,i.jsx)(n.p,{children:"If not explicitly defined, there might be a system-specific or default value that applies."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(globalResponseTimeout: 5000) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this given example, setting the ",(0,i.jsx)(n.code,{children:"globalResponseTimeout"})," to ",(0,i.jsx)(n.code,{children:"5000"})," milliseconds, or 5 seconds, means any query execution taking longer than this duration will be automatically terminated by"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Setting an appropriate response timeout in production environments is crucial. This optimizes resource use and serves as a security measure against potential denial-of-service attacks, where adversaries might run complex queries to exhaust server resources."})}),"\n",(0,i.jsx)(n.h3,{id:"version",children:"version"}),"\n",(0,i.jsxs)(n.p,{children:["The server uses the HTTP version. If not specified, the default value is ",(0,i.jsx)(n.code,{children:"HTTP1"}),". The available options are ",(0,i.jsx)(n.code,{children:"HTTP1"})," and ",(0,i.jsx)(n.code,{children:"HTTP2"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(version: HTTP2) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"cert-1",children:"cert"}),"\n",(0,i.jsxs)(n.p,{children:["The path to certificate(s) for running the server over HTTP2 (HTTPS). If not specified, the default value is ",(0,i.jsx)(n.code,{children:"null"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema @server(cert: "./cert.pem") {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["The certificate can be of any extension, but it's highly recommended to use standards (",(0,i.jsx)(n.code,{children:"pem"}),", ",(0,i.jsx)(n.code,{children:"crt"}),", ",(0,i.jsx)(n.code,{children:"key"}),")."]})}),"\n",(0,i.jsx)(n.h3,{id:"key-1",children:"key"}),"\n",(0,i.jsxs)(n.p,{children:["The path to the key for running the server over HTTP2 (HTTPS). If not specified, the default value is ",(0,i.jsx)(n.code,{children:"null"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema @server(key: "./key.pem") {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["The key can be of any extension, but it's highly recommended to use standards (",(0,i.jsx)(n.code,{children:"pem"}),", ",(0,i.jsx)(n.code,{children:"crt"}),", ",(0,i.jsx)(n.code,{children:"key"}),")."]})}),"\n",(0,i.jsx)(n.h3,{id:"showcase",children:"showcase"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@server"})," directive's ",(0,i.jsx)(n.code,{children:"showcase"})," option allows for hands-on experimentation with server configurations in a controlled environment. This feature simplifies the process of exploring and testing different settings."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(showcase: true) {\n  query: Query\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"batchrequests",children:"batchRequests"}),"\n",(0,i.jsx)(n.p,{children:"Batching in GraphQL combines requests into one, reducing server round trips."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(\n  port: 8000\n  batchRequests: true\n)\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Batching can improve performance but may introduce latency if one request in the batch takes longer. It also makes network traffic debugging harder."})}),"\n",(0,i.jsx)(n.h3,{id:"dedupe",children:"dedupe"}),"\n",(0,i.jsxs)(n.p,{children:["A boolean flag, if set to ",(0,i.jsx)(n.code,{children:"true"}),", will enable deduplication of IO operations to enhance performance. This flag prevents duplicate IO requests from being executed concurrently, reducing resource load. If not specified, this feature defaults to ",(0,i.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(\n  port: 8000\n  dedupe: true\n)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"routes",children:"routes"}),"\n",(0,i.jsx)(n.p,{children:"This optional field allows you to customize the server's endpoint paths, enabling you to override the default values for the GraphQL and status endpoints. If not specified, the following default paths will be used:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["graphQL: ",(0,i.jsx)(n.code,{children:"/graphql"})]}),"\n",(0,i.jsxs)(n.li,{children:["status: ",(0,i.jsx)(n.code,{children:"/status"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema @server(routes: {graphQL: "/tailcall-gql", status: "/health"})\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the GraphQL endpoint is changed to ",(0,i.jsx)(n.code,{children:"/tailcall-gql"})," and the status endpoint to ",(0,i.jsx)(n.code,{children:"/health"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"enablefederation",children:"enableFederation"}),"\n",(0,i.jsxs)(n.p,{children:["A boolean flag, if set to ",(0,i.jsx)(n.code,{children:"true"})," the Tailcall server will additionally act as federation subgraph. By default, it's disabled."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @server(enableFederation: true)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"telemetry-directive",children:"@telemetry Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@telemetry"})," directive facilitates seamless integration with ",(0,i.jsx)(n.a,{href:"https://open-telemetry.io",children:"OpenTelemetry"}),", enhancing the observability of your GraphQL services powered by Tailcall. By leveraging this directive, developers gain access to valuable insights into the performance and behavior of their applications."]}),"\n",(0,i.jsx)(n.h3,{id:"traces",children:"Traces"}),"\n",(0,i.jsxs)(n.p,{children:["Here are the traces that are captured by the ",(0,i.jsx)(n.code,{children:"@telemetry"})," directive:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Trace Name"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"request"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Captures the span for processing the HTTP request on the server side, providing foundational observability."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"graphQL"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,i.jsx)(n.em,{children:"Only for GraphQL ingress"}),". Span for processing GraphQL call"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:(0,i.jsx)(n.code,{children:"REST <http_method> <http_route>"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,i.jsx)(n.em,{children:"Only for REST ingress"}),". Span for processing REST API call"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:(0,i.jsx)(n.code,{children:"<field_name>"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Denotes spans for fields with defined resolvers, offering insights into field names and execution times for resolver logic."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:(0,i.jsx)(n.code,{children:"<expr_name>"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Nested within the ",(0,i.jsx)(n.code,{children:"<field_name>"})," spans, these granulated spans detail the execution of expressions in resolving a field, highlighting the hierarchical execution pattern of nested expressions."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"upstream_request"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Request that were made from tailcall service to upstream"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"metrics",children:"Metrics"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@telemetry"})," directive also captures the following metrics:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Metric"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"cache.hit_rate"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Reflects the cache hit rate for the cache powered by the ",(0,i.jsx)(n.a,{href:"#cache-directive",children:(0,i.jsx)(n.code,{children:"@cache"})})," directive"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"http.server.request.count"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Counts the number of incoming requests made to specific route. Optionally enriched with selected headers by ",(0,i.jsx)(n.a,{href:"#requestheaders",children:(0,i.jsx)(n.code,{children:"requestHeaders"})})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"http.client.request.count"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Counts the number of outgoing requests to specific upstream"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"export",children:"export"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"export"})," field defines how the open-telemetry data should be exported and in which format. The following are the supported formats:"]}),"\n",(0,i.jsx)(n.h3,{id:"otlp",children:"otlp"}),"\n",(0,i.jsx)(n.p,{children:"Utilizes the OTLP format to export telemetry data to backend systems, supported by most modern tracing and analytics platforms. Here is an example using [honeycomb.io]:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema\n  @telemetry(\n    export: {\n      otlp: {\n        url: "https://api.honeycomb.io:443"\n        headers: [\n          {\n            key: "x-honeycomb-team"\n            value: "{{.env.HONEYCOMB_API_KEY}}"\n          }\n          {key: "x-honeycomb-dataset", value: "tailcall"}\n        ]\n      }\n    }\n  ) {\n  query: Query\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"You can configure the OTLP exporter with the following options:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Field"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"url"}),(0,i.jsx)(n.td,{children:"Defines the URL for the OTLP Collector."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"headers"}),(0,i.jsx)(n.td,{children:"Sets additional headers for requests to the OTLP Collector."})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"prometheus",children:"prometheus"}),"\n",(0,i.jsx)(n.p,{children:"Facilitates metrics export in a Prometheus compatible format, providing a dedicated endpoint for metrics."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema\n  @telemetry(export: {prometheus: {path: "/metrics"}}) {\n  query: Query\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"You can configure the Prometheus exporter with the following options:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Field"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"path"}),(0,i.jsxs)(n.td,{children:["Designates the endpoint path for Prometheus metrics, defaulting to ",(0,i.jsx)(n.code,{children:"/metrics"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"format"}),(0,i.jsxs)(n.td,{children:["Controls the format viz. ",(0,i.jsx)(n.strong,{children:"text"})," or ",(0,i.jsx)(n.strong,{children:"protobuf"}),", for sending data to Prometheus."]})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"stdout",children:"stdout"}),"\n",(0,i.jsx)(n.p,{children:"Outputs all telemetry data to stdout, ideal for testing or local development environments."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:"schema @telemetry(export: {stdout: {pretty: true}}) {\n  query: Query\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can configure the stdout exporter with the following options:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Field"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"pretty"}),(0,i.jsx)(n.td,{children:"Enables formatted output of telemetry data for enhanced readability."})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"requestheaders",children:"requestHeaders"}),"\n",(0,i.jsx)(n.p,{children:"Specifies list of headers of ingress request the value of which will be sent to the telemetry as attributes."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema @telemetry(requestHeaders: ["X-User-Id"]) {\n  query: Query\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"apollo",children:"apollo"}),"\n",(0,i.jsxs)(n.p,{children:["Facilitates seamless integration with ",(0,i.jsx)(n.a,{href:"https://studio.apollographql.com/",children:"Apollo Studio"}),", enhancing the observability of GraphQL services. By leveraging this field, developers gain access to valuable insights into the performance and behavior of their GraphQL APIs."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema\n  @telemetry(\n    export: {\n      otlp: {\n        api_key: "{{.env.APOLLO_API_KEY}}"\n        graph_ref: "graph-id@current"\n        platform: "website.com"\n        version: "1.0.0"\n      }\n    }\n  ) {\n  query: Query\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"You can configure the apollo exporter with the following options:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"right"},children:"Field"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"api_key"}),(0,i.jsx)(n.td,{children:"The API Key generated from Apollo Studio."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"graph_ref"}),(0,i.jsxs)(n.td,{children:["The Graph Ref, which is the ",(0,i.jsx)(n.code,{children:"graph_id"})," and the ",(0,i.jsx)(n.code,{children:"variant"})," concatenated using ",(0,i.jsx)(n.code,{children:"@"}),"(i.e. <graph_id>@<variant>)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"platform"}),(0,i.jsx)(n.td,{children:"An arbitrary value which can contain the name of your website or some other value to identify your deployment uniqely, in case you have multiple deployments."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"right"},children:"version"}),(0,i.jsx)(n.td,{children:"Version of Apollo which is being used."})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["By integrating the ",(0,i.jsx)(n.code,{children:"@telemetry"})," directive into your GraphQL schema, you empower your development teams with critical insights into application performance, enabling proactive optimization and maintenance."]}),"\n",(0,i.jsx)(n.h2,{id:"upstream-directive",children:"@upstream Directive"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"upstream"})," directive enables control over specific aspects of the upstream server connection, including settings such as connection timeouts, keep-alive intervals, and more. The system applies default values if you do not specify them."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @upstream(...[UpstreamSetting]...){\n    query: Query\n    mutation: Mutation\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The document below details the options for ",(0,i.jsx)(n.code,{children:"UpstreamSetting"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"poolidletimeout",children:"poolIdleTimeout"}),"\n",(0,i.jsx)(n.p,{children:"The connection pool waits for this duration in seconds before closing idle connections."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    poolIdleTimeout: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"poolmaxidleperhost",children:"poolMaxIdlePerHost"}),"\n",(0,i.jsx)(n.p,{children:"The max number of idle connections each host will maintain."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    poolMaxIdlePerHost: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"keepaliveinterval",children:"keepAliveInterval"}),"\n",(0,i.jsx)(n.p,{children:"The time in seconds between each keep-alive message sent to maintain the connection."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    keepAliveInterval: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"keepalivetimeout",children:"keepAliveTimeout"}),"\n",(0,i.jsx)(n.p,{children:"The time in seconds that the connection will wait for a keep-alive message before closing."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    keepAliveTimeout: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"keepalivewhileidle",children:"keepAliveWhileIdle"}),"\n",(0,i.jsx)(n.p,{children:"A boolean value that determines whether to send keep-alive messages while the connection is idle."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    keepAliveWhileIdle: false\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"proxy",children:"proxy"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"proxy"})," setting defines an intermediary server that routes upstream requests before they reach their intended endpoint. By specifying a proxy URL, you introduce a layer, enabling custom routing and security policies."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    proxy: {url: "http://localhost:3000"}\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In the provided example, we've set the proxy's ",(0,i.jsx)(n.code,{children:"url"}),' to "',(0,i.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"}),'". This configuration ensures that all requests aimed at the designated ',(0,i.jsx)(n.code,{children:"baseURL"})," first go through this proxy. To illustrate, if the ",(0,i.jsx)(n.code,{children:"baseURL"}),' is "',(0,i.jsx)(n.a,{href:"http://jsonplaceholder.typicode.com",children:"http://jsonplaceholder.typicode.com"}),'", any request targeting it initially goes to "',(0,i.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"}),'" before the proxy redirects it to its final destination.']}),"\n",(0,i.jsx)(n.h3,{id:"connecttimeout",children:"connectTimeout"}),"\n",(0,i.jsx)(n.p,{children:"The time in seconds that the connection will wait for a response before timing out."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    connectTimeout: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"timeout",children:"timeout"}),"\n",(0,i.jsx)(n.p,{children:"The max time in seconds that the connection will wait for a response."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    timeout: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"tcpkeepalive",children:"tcpKeepAlive"}),"\n",(0,i.jsx)(n.p,{children:"The time in seconds between each TCP keep-alive message sent to maintain the connection."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    tcpKeepAlive: 60\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"useragent",children:"userAgent"}),"\n",(0,i.jsx)(n.p,{children:"The User-Agent header value for HTTP requests."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    userAgent: "Tailcall/1.0"\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"allowedheaders",children:"allowedHeaders"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"allowedHeaders"})," configuration defines a set of whitelisted HTTP headers that can be forwarded to upstream services during requests.\nWithout specifying ",(0,i.jsx)(n.code,{children:"allowedHeaders"}),", the system will not forward any incoming headers to upstream services, offering an extra security layer but potentially limiting necessary data flow. Tailcall compares the provided whitelisted headers in a case-insensitive format."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    allowedHeaders: ["Authorization", "X-Api-Key"]\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In the example above, the configuration for ",(0,i.jsx)(n.code,{children:"allowedHeaders"})," permits ",(0,i.jsx)(n.code,{children:"Authorization"})," and ",(0,i.jsx)(n.code,{children:"X-Api-Key"})," headers. Thus, requests with these headers will forward them to upstream services; the system ignores all others. This configuration ensures communication of the expected headers to dependent services, emphasizing security and consistency."]}),"\n",(0,i.jsx)(n.h3,{id:"baseurl-3",children:"baseURL"}),"\n",(0,i.jsxs)(n.p,{children:["This refers to the default base URL for your APIs. If it's not explicitly mentioned in the ",(0,i.jsx)(n.code,{children:"@upstream"})," directive, then each ",(0,i.jsx)(n.a,{href:"#http-directive",children:(0,i.jsx)(n.code,{children:"@http"})})," directive must specify its own ",(0,i.jsx)(n.code,{children:"baseURL"}),". If neither ",(0,i.jsx)(n.code,{children:"@upstream"})," nor ",(0,i.jsx)(n.a,{href:"#http-directive",children:(0,i.jsx)(n.code,{children:"@http"})})," provides a ",(0,i.jsx)(n.code,{children:"baseURL"}),", it results in a compilation error."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this representation, ",(0,i.jsx)(n.code,{children:"http://jsonplaceholder.typicode.com"})," serves as the ",(0,i.jsx)(n.code,{children:"baseURL"}),". Thus, all API calls made by ",(0,i.jsx)(n.code,{children:"@http"})," prepend this URL to their respective paths."]}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.p,{children:"Ensure that your base URL remains free from specific path segments."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GOOD:"})," ",(0,i.jsx)(n.code,{children:"@upstream(baseURL: http://jsonplaceholder.typicode.com)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"BAD:"})," ",(0,i.jsx)(n.code,{children:"@upstream(baseURL: http://jsonplaceholder.typicode.com/api)"})]}),"\n"]})]}),"\n",(0,i.jsx)(n.h3,{id:"httpcache",children:"httpCache"}),"\n",(0,i.jsxs)(n.p,{children:["When httpCache passed with value greater than 0 it directs Tailcall to use HTTP caching mechanisms, following the ",(0,i.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc7234",children:"HTTP Caching RFC"})," to enhance performance by minimizing unnecessary data fetches. If left unspecified, this feature defaults to ",(0,i.jsx)(n.code,{children:"0"})," disabling the caching mechanism."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @upstream(httpCache: 42) {\n  query: Query\n  mutation: Mutation\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tips",children:"Tips"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use batching when other optimization techniques fail to resolve performance issues."}),"\n",(0,i.jsx)(n.li,{children:"Apply batching and thoroughly assess its impact."}),"\n",(0,i.jsx)(n.li,{children:"Understand that batching may make debugging more challenging."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"batch-1",children:"batch"}),"\n",(0,i.jsxs)(n.p,{children:["An object that specifies the batch settings, including ",(0,i.jsx)(n.code,{children:"maxSize"})," (the max size of the batch), ",(0,i.jsx)(n.code,{children:"delay"})," (the delay in milliseconds between each batch), and ",(0,i.jsx)(n.code,{children:"headers"})," (an array of HTTP headers that the batch will include)."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:'schema\n  @upstream(\n    batch: {\n      maxSize: 1000\n      delay: 10\n      headers: ["X-Server", "Authorization"]\n    }\n  ) {\n  query: Query\n  mutation: Mutation\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onrequest-1",children:"onRequest"}),"\n",(0,i.jsxs)(n.p,{children:["Similar to the ",(0,i.jsx)(n.a,{href:"#http-directive",children:"@http"})," property, this accepts a string value representing a middleware function defined in a JavaScript file. It intercepts all outgoing HTTP requests from the server. This interceptor, written in JavaScript, can be used to modify outgoing requests and also generate artificial responses to customize the behavior of the GraphQL server."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",metastring:"showLineNumbers",children:"schema @upstream(onRequest: 'someFunctionName')\n@link(type: Script, src: \"path_to/worker.js\") {\n  query: Query\n  mutation: Mutation\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},21400:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/rest-user-03cf9e415f57084d2cbfcaebac90df2b.png"},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(96540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);