"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1625],{85573:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var i=t(74848),l=t(28453);const s={title:"Deploy Tailcall GraphQL on Fly.io",sidebar_label:"Deploy on Fly",description:"Learn how to deploy Tailcall GraphQL servers on Fly.io using GitHub Actions quickly and securely.",slug:"deploy-tailcall-graphql-fly-actions"},o=void 0,a={id:"tailcall-on-fly",title:"Deploy Tailcall GraphQL on Fly.io",description:"Learn how to deploy Tailcall GraphQL servers on Fly.io using GitHub Actions quickly and securely.",source:"@site/docs/tailcall-on-fly.md",sourceDirName:".",slug:"/deploy-tailcall-graphql-fly-actions",permalink:"/docs/deploy-tailcall-graphql-fly-actions",draft:!1,unlisted:!1,editUrl:"https://github.com/tailcallhq/tailcallhq.github.io/tree/develop/docs/tailcall-on-fly.md",tags:[],version:"current",lastUpdatedAt:1719143442e3,frontMatter:{title:"Deploy Tailcall GraphQL on Fly.io",sidebar_label:"Deploy on Fly",description:"Learn how to deploy Tailcall GraphQL servers on Fly.io using GitHub Actions quickly and securely.",slug:"deploy-tailcall-graphql-fly-actions"},sidebar:"docs",previous:{title:"Deployments",permalink:"/docs/deploy-graphql-github-actions"},next:{title:"Deploy on AWS",permalink:"/docs/tailcall-on-aws"}},r={},c=[{value:"Generate API Key for Fly.io",id:"generate-api-key-for-flyio",level:2},{value:"Setting Up the Project Repository",id:"setting-up-the-project-repository",level:2},{value:"Deploy on Fly.io",id:"deploy-on-flyio",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["To deploy ",(0,i.jsx)(n.code,{children:"tailcall"})," on Fly.io, you first need to generate an API key from Fly.io. If you don't already have an account, you can create one ",(0,i.jsx)(n.a,{href:"https://fly.io/app/sign-up",children:"here"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"generate-api-key-for-flyio",children:"Generate API Key for Fly.io"}),"\n",(0,i.jsx)(n.p,{children:"Follow these steps to generate an API key:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the ",(0,i.jsx)(n.a,{href:"https://fly.io/dashboard",children:"Fly.io dashboard"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"dashboard.png",src:t(76368).A+"",width:"1508",height:"925"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click on ",(0,i.jsx)(n.code,{children:"Tokens"})," in the left sidebar."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"tokens.png",src:t(96508).A+"",width:"1512",height:"925"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Optionally, provide a name and an expiry date for the token. Click on ",(0,i.jsx)(n.code,{children:"Create Organization Token"})," to generate the token."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"token.png",src:t(45079).A+"",width:"1510",height:"924"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Copy the generated token and store it securely. You will need this token as input to the ",(0,i.jsx)(n.a,{href:"https://github.com/tailcallhq/gh-action",children:"tailcallhq/gh-action"})," when deploying to Fly.io."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-the-project-repository",children:"Setting Up the Project Repository"}),"\n",(0,i.jsxs)(n.p,{children:["Next, create a new repository on GitHub and use the ",(0,i.jsx)(n.code,{children:"tailcallhq/gh-action"})," GitHub action to deploy it. The easiest way to get started is by using this template repository: ",(0,i.jsx)(n.a,{href:"https://github.com/tailcallhq/deploy-tailcall",children:"https://github.com/tailcallhq/deploy-tailcall"}),"."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the repository and click on ",(0,i.jsx)(n.code,{children:"Use this template"})," to create a new repository."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"github-template.png",src:t(86384).A+"",width:"1512",height:"924"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Name your repository and click on ",(0,i.jsx)(n.code,{children:"Create repository"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"create-repo.png",src:t(66509).A+"",width:"1512",height:"924"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["After creating the repository, add the Fly.io API token to the repository secrets. To do this, click on ",(0,i.jsx)(n.code,{children:"Settings"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"settings.png",src:t(17565).A+"",width:"1512",height:"927"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click on ",(0,i.jsx)(n.code,{children:"Secrets and variables"})," in the left sidebar to expand the section, then click on ",(0,i.jsx)(n.code,{children:"Actions"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"actions.png",src:t(32197).A+"",width:"1512",height:"925"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click on ",(0,i.jsx)(n.code,{children:"New repository secret"})," to add a new secret."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"new-repo-secret.png",src:t(47920).A+"",width:"1512",height:"927"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Name the secret ",(0,i.jsx)(n.code,{children:"FLY_API_TOKEN"})," or any preferred name, and paste the Fly.io API token you generated ",(0,i.jsx)(n.a,{href:"#generate-api-key-for-flyio",children:"earlier"})," into the value field. Click on ",(0,i.jsx)(n.code,{children:"Add secret"})," to save it."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"secret.png",src:t(14590).A+"",width:"1512",height:"927"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You are now ready to deploy your ",(0,i.jsx)(n.code,{children:"tailcall"})," server on Fly.io."]}),"\n",(0,i.jsx)(n.h2,{id:"deploy-on-flyio",children:"Deploy on Fly.io"}),"\n",(0,i.jsxs)(n.p,{children:["In this example, we will deploy a simple GraphQL server using ",(0,i.jsx)(n.code,{children:"tailcall"})," on Fly.io, which converts the JSONPlaceholder REST API to a GraphQL API."]}),"\n",(0,i.jsx)(n.p,{children:"Below is the configuration present in the template repository, which will be used for this deployment."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["You can learn more about the configuration ",(0,i.jsx)(n.a,{href:"/docs/tailcall-graphql-configuration-format-conversion",children:"here"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'schema\n  @upstream(\n    baseURL: "http://jsonplaceholder.typicode.com"\n  ) {\n  query: Query\n}\n\ntype Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype User {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n}\n\ntype Post {\n  id: Int!\n  userId: Int!\n  title: String!\n  body: String!\n  user: User @http(path: "/users/{{.value.userId}}")\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["To deploy the server, update the ",(0,i.jsx)(n.code,{children:"provider"})," to ",(0,i.jsx)(n.code,{children:"fly"})," in the ",(0,i.jsx)(n.code,{children:"deploy-tailcall"})," job in the ",(0,i.jsx)(n.code,{children:".github/workflows/main.yml"})," file, as shown below."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'on: [push]\n\njobs:\n  deploy_tailcall:\n    runs-on: ubuntu-latest\n    name: Deploy Tailcall\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v2\n      - name: Deploy Tailcall\n        id: deploy-tailcall\n        uses: tailcallhq/gh-action@<version> # Replace <version> with the desired version\n        with:\n          provider: "fly" # Specifies the cloud provider as \'fly\'\n          fly-api-token: ${{ secrets.FLY_API_TOKEN }}\n          fly-app-name: <app-name> # Replace <app-name> with the desired app name\n          fly-region: "lax"\n          tailcall-config: "./config.graphql"\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:["When specifying the ",(0,i.jsx)(n.code,{children:"fly-app-name"})," in your GitHub Actions workflow for deploying to Fly.io, ensure the app name you choose is unique across all Fly.io users."]})}),"\n",(0,i.jsxs)(n.p,{children:["Fly.io requires each app name to be globally unique. If the name you select is already taken by another user, your deployment will fail. To avoid this issue, consider using a name that includes unique identifiers such as your organization name, project name, etc. If you do not specify the app name, ",(0,i.jsx)(n.code,{children:"<orgname>-<reponame>"})," will be used."]}),"\n",(0,i.jsxs)(n.p,{children:["After updating the ",(0,i.jsx)(n.code,{children:"main.yml"})," file, commit the changes and push them to the repository. This will trigger the deployment of the ",(0,i.jsx)(n.code,{children:"tailcall"})," server on Fly.io. Once the deployment is successful, you can access the GraphQL playground at ",(0,i.jsx)(n.code,{children:"https://tailcall.run/playground/?u=https://<fly-app-name>.fly.dev/graphql"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},32197:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/actions-5aa5e47264821cfaf923d99caec8f556.png"},66509:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/create-repo-3809fc429b8affa306eca1632154a296.png"},76368:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/dashboard-8f35845e602d92b224ca261a8fbf329b.png"},86384:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/github-template-0898f5cf0de3207dad1d6d54159fb9db.png"},47920:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/new-repo-secret-eea25c532dedba214e99f9d74589b49f.png"},14590:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/secret-c4b448a1b91581d51b5d712b40f67e53.png"},17565:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/settings-4fb89767d1b966bc883f22e8ea557ab9.png"},45079:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/token-80ce77e615292c89df3b4da5cb5e0290.png"},96508:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/tokens-b612ede260fe6a36fe69b3ff35aba78c.png"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(96540);const l={},s=i.createContext(l);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);